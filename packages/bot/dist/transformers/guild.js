import { ChannelTypes } from '@discordeno/types';
import { Collection, iconHashToBigInt } from '@discordeno/utils';
import { GuildToggles } from './toggles/guild.js';
export const baseGuild = {
    // This allows typescript to still check for type errors on functions below
    ...undefined,
    get threads () {
        if (!this.channels) return new Collection();
        const threads = this.channels.array().filter((x)=>x.type === ChannelTypes.PublicThread || x.type === ChannelTypes.PrivateThread || x.type === ChannelTypes.AnnouncementThread);
        return new Collection(threads.map((x)=>[
                x.id,
                x
            ]));
    },
    get features () {
        return this.toggles.features;
    }
};
export function transformGuild(bot, payload, extra) {
    const guildId = bot.transformers.snowflake(payload.id);
    const props = bot.transformers.desiredProperties.guild;
    const guild = Object.create(baseGuild);
    if (props.afkTimeout && payload.afk_timeout) guild.afkTimeout = payload.afk_timeout;
    if (props.approximateMemberCount && payload.approximate_member_count) guild.approximateMemberCount = payload.approximate_member_count;
    if (props.approximatePresenceCount && payload.approximate_presence_count) guild.approximatePresenceCount = payload.approximate_presence_count;
    if (props.defaultMessageNotifications) guild.defaultMessageNotifications = payload.default_message_notifications;
    if (props.description && payload.description) guild.description = payload.description;
    if (props.toggles) guild.toggles = new GuildToggles(payload);
    if (props.explicitContentFilter) guild.explicitContentFilter = payload.explicit_content_filter;
    if (props.maxMembers && payload.max_members) guild.maxMembers = payload.max_members;
    if (props.maxPresences && payload.max_presences) guild.maxPresences = payload.max_presences ?? undefined;
    if (props.maxVideoChannelUsers && payload.max_video_channel_users) guild.maxVideoChannelUsers = payload.max_video_channel_users;
    if (props.maxStageVideoChannelUsers && payload.max_stage_video_channel_users) guild.maxStageVideoChannelUsers = payload.max_stage_video_channel_users;
    if (props.mfaLevel) guild.mfaLevel = payload.mfa_level;
    if (props.name && payload.name) guild.name = payload.name;
    if (props.nsfwLevel) guild.nsfwLevel = payload.nsfw_level;
    if (props.preferredLocale && payload.preferred_locale) guild.preferredLocale = payload.preferred_locale;
    if (props.premiumSubscriptionCount && payload.premium_subscription_count !== undefined) guild.premiumSubscriptionCount = payload.premium_subscription_count;
    if (props.premiumTier) guild.premiumTier = payload.premium_tier;
    if (props.stageInstances && payload.stage_instances) guild.stageInstances = payload.stage_instances.map((si)=>({
            /** The id of this Stage instance */ id: bot.transformers.snowflake(si.id),
            /** The guild id of the associated Stage channel */ guildId,
            /** The id of the associated Stage channel */ channelId: bot.transformers.snowflake(si.channel_id),
            /** The topic of the Stage instance (1-120 characters) */ topic: si.topic
        }));
    if (props.channels && (!!payload.channels || !!payload.threads)) guild.channels = new Collection([
        ...payload.channels ?? [],
        ...payload.threads ?? []
    ].map((channel)=>{
        const result = bot.transformers.channel(bot, channel, {
            guildId
        });
        // TODO: We should check that id exists, or else the collection will have undefined as it's key (This is valid for all the collections below as well)
        // @ts-expect-error: See TODO above
        return [
            result.id,
            result
        ];
    }));
    if (props.members && payload.members) guild.members = new Collection(payload.members.map((member)=>{
        const result = bot.transformers.member(bot, member, {
            guildId,
            userId: bot.transformers.snowflake(member.user.id)
        });
        // @ts-expect-error: See TODO above
        return [
            result.id,
            result
        ];
    }));
    if (props.roles && payload.roles) guild.roles = new Collection(payload.roles.map((role)=>{
        const result = bot.transformers.role(bot, role, {
            guildId
        });
        // @ts-expect-error: See TODO above
        return [
            result.id,
            result
        ];
    }));
    if (props.emojis && payload.emojis) guild.emojis = new Collection(payload.emojis.map((emoji)=>{
        const result = bot.transformers.emoji(bot, emoji);
        // @ts-expect-error: See TODO above
        return [
            result.id,
            result
        ];
    }));
    if (props.voiceStates && payload.voice_states) guild.voiceStates = new Collection(payload.voice_states.map((voiceState)=>{
        const result = bot.transformers.voiceState(bot, voiceState, {
            guildId
        });
        // @ts-expect-error: See TODO above
        return [
            result.userId,
            result
        ];
    }));
    if (props.stickers && payload.stickers) guild.stickers = new Collection(payload.stickers?.map((sticker)=>{
        const result = bot.transformers.sticker(bot, sticker);
        // @ts-expect-error: See TODO above
        return [
            result.id,
            result
        ];
    }));
    if (props.systemChannelFlags && payload.system_channel_flags) guild.systemChannelFlags = payload.system_channel_flags;
    if (props.vanityUrlCode && payload.vanity_url_code) guild.vanityUrlCode = payload.vanity_url_code;
    if (props.verificationLevel) guild.verificationLevel = payload.verification_level;
    if (props.welcomeScreen && payload.welcome_screen) guild.welcomeScreen = {
        description: payload.welcome_screen.description ?? undefined,
        welcomeChannels: payload.welcome_screen.welcome_channels.map((wc)=>({
                channelId: bot.transformers.snowflake(wc.channel_id),
                description: wc.description,
                emojiId: wc.emoji_id ? bot.transformers.snowflake(wc.emoji_id) : undefined,
                emojiName: wc.emoji_name ?? undefined
            }))
    };
    if (props.discoverySplash && payload.discovery_splash) guild.discoverySplash = iconHashToBigInt(payload.discovery_splash);
    if (props.joinedAt && payload.joined_at) guild.joinedAt = Date.parse(payload.joined_at);
    if (props.memberCount && payload.member_count) guild.memberCount = payload.member_count ?? 0;
    if (props.shardId && extra?.shardId) guild.shardId = extra.shardId;
    if (props.icon && payload.icon) guild.icon = iconHashToBigInt(payload.icon);
    if (props.banner && payload.banner) guild.banner = iconHashToBigInt(payload.banner);
    if (props.splash && payload.splash) guild.splash = iconHashToBigInt(payload.splash);
    if (props.id && payload.id) guild.id = guildId;
    if (props.ownerId && payload.owner_id) guild.ownerId = bot.transformers.snowflake(payload.owner_id);
    if (props.permissions && payload.permissions) guild.permissions = bot.transformers.snowflake(payload.permissions);
    if (props.afkChannelId && payload.afk_channel_id) guild.afkChannelId = bot.transformers.snowflake(payload.afk_channel_id);
    if (props.widgetChannelId && payload.widget_channel_id) guild.widgetChannelId = bot.transformers.snowflake(payload.widget_channel_id);
    if (props.applicationId && payload.application_id) guild.applicationId = bot.transformers.snowflake(payload.application_id);
    if (props.systemChannelId && payload.system_channel_id) guild.systemChannelId = bot.transformers.snowflake(payload.system_channel_id);
    if (props.rulesChannelId && payload.rules_channel_id) guild.rulesChannelId = bot.transformers.snowflake(payload.rules_channel_id);
    if (props.publicUpdatesChannelId && payload.public_updates_channel_id) guild.publicUpdatesChannelId = bot.transformers.snowflake(payload.public_updates_channel_id);
    if (props.premiumProgressBarEnabled && payload.premium_progress_bar_enabled) guild.premiumProgressBarEnabled = payload.premium_progress_bar_enabled;
    if (props.large && payload.large) guild.large = payload.large;
    if (props.owner && payload.owner) guild.owner = payload.owner;
    if (props.widgetEnabled && payload.widget_enabled) guild.widgetEnabled = payload.widget_enabled;
    if (props.unavailable && payload.unavailable) guild.unavailable = payload.unavailable;
    if (props.iconHash && payload.icon_hash) guild.iconHash = iconHashToBigInt(payload.icon_hash);
    if (props.presences && payload.presences) guild.presences = payload.presences?.map((presence)=>bot.transformers.presence(bot, presence));
    if (props.safetyAlertsChannelId && payload.safety_alerts_channel_id) guild.safetyAlertsChannelId = bot.transformers.snowflake(payload.safety_alerts_channel_id);
    if (props.incidentsData && payload.incidents_data) guild.incidentsData = bot.transformers.incidentsData(bot, payload.incidents_data);
    return bot.transformers.customizers.guild(bot, payload, guild, extra);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90cmFuc2Zvcm1lcnMvZ3VpbGQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhbm5lbFR5cGVzLCB0eXBlIERpc2NvcmRHdWlsZCwgdHlwZSBEaXNjb3JkUHJlc2VuY2VVcGRhdGUgfSBmcm9tICdAZGlzY29yZGVuby90eXBlcydcbmltcG9ydCB7IENvbGxlY3Rpb24sIGljb25IYXNoVG9CaWdJbnQgfSBmcm9tICdAZGlzY29yZGVuby91dGlscydcbmltcG9ydCB0eXBlIHsgQm90IH0gZnJvbSAnLi4vYm90LmpzJ1xuaW1wb3J0IHR5cGUgeyBEZXNpcmVkUHJvcGVydGllc0JlaGF2aW9yLCBTZXR1cERlc2lyZWRQcm9wcywgVHJhbnNmb3JtZXJzRGVzaXJlZFByb3BlcnRpZXMgfSBmcm9tICcuLi9kZXNpcmVkUHJvcGVydGllcy5qcydcbmltcG9ydCB7IEd1aWxkVG9nZ2xlcyB9IGZyb20gJy4vdG9nZ2xlcy9ndWlsZC5qcydcbmltcG9ydCB0eXBlIHsgQ2hhbm5lbCwgR3VpbGQgfSBmcm9tICcuL3R5cGVzLmpzJ1xuXG5leHBvcnQgY29uc3QgYmFzZUd1aWxkOiBHdWlsZCA9IHtcbiAgLy8gVGhpcyBhbGxvd3MgdHlwZXNjcmlwdCB0byBzdGlsbCBjaGVjayBmb3IgdHlwZSBlcnJvcnMgb24gZnVuY3Rpb25zIGJlbG93XG4gIC4uLih1bmRlZmluZWQgYXMgdW5rbm93biBhcyBHdWlsZCksXG5cbiAgZ2V0IHRocmVhZHMoKSB7XG4gICAgaWYgKCF0aGlzLmNoYW5uZWxzKSByZXR1cm4gbmV3IENvbGxlY3Rpb248YmlnaW50LCBDaGFubmVsPigpXG5cbiAgICBjb25zdCB0aHJlYWRzID0gdGhpcy5jaGFubmVsc1xuICAgICAgLmFycmF5KClcbiAgICAgIC5maWx0ZXIoKHgpID0+IHgudHlwZSA9PT0gQ2hhbm5lbFR5cGVzLlB1YmxpY1RocmVhZCB8fCB4LnR5cGUgPT09IENoYW5uZWxUeXBlcy5Qcml2YXRlVGhyZWFkIHx8IHgudHlwZSA9PT0gQ2hhbm5lbFR5cGVzLkFubm91bmNlbWVudFRocmVhZClcblxuICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbih0aHJlYWRzLm1hcCgoeCkgPT4gW3guaWQsIHhdKSlcbiAgfSxcbiAgZ2V0IGZlYXR1cmVzKCkge1xuICAgIHJldHVybiB0aGlzLnRvZ2dsZXMuZmVhdHVyZXNcbiAgfSxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zZm9ybUd1aWxkKGJvdDogQm90LCBwYXlsb2FkOiBEaXNjb3JkR3VpbGQsIGV4dHJhPzogeyBzaGFyZElkPzogbnVtYmVyIH0pOiBHdWlsZCB7XG4gIGNvbnN0IGd1aWxkSWQgPSBib3QudHJhbnNmb3JtZXJzLnNub3dmbGFrZShwYXlsb2FkLmlkKVxuICBjb25zdCBwcm9wcyA9IGJvdC50cmFuc2Zvcm1lcnMuZGVzaXJlZFByb3BlcnRpZXMuZ3VpbGRcbiAgY29uc3QgZ3VpbGQ6IFNldHVwRGVzaXJlZFByb3BzPEd1aWxkLCBUcmFuc2Zvcm1lcnNEZXNpcmVkUHJvcGVydGllcywgRGVzaXJlZFByb3BlcnRpZXNCZWhhdmlvcj4gPSBPYmplY3QuY3JlYXRlKGJhc2VHdWlsZClcblxuICBpZiAocHJvcHMuYWZrVGltZW91dCAmJiBwYXlsb2FkLmFma190aW1lb3V0KSBndWlsZC5hZmtUaW1lb3V0ID0gcGF5bG9hZC5hZmtfdGltZW91dFxuICBpZiAocHJvcHMuYXBwcm94aW1hdGVNZW1iZXJDb3VudCAmJiBwYXlsb2FkLmFwcHJveGltYXRlX21lbWJlcl9jb3VudCkgZ3VpbGQuYXBwcm94aW1hdGVNZW1iZXJDb3VudCA9IHBheWxvYWQuYXBwcm94aW1hdGVfbWVtYmVyX2NvdW50XG4gIGlmIChwcm9wcy5hcHByb3hpbWF0ZVByZXNlbmNlQ291bnQgJiYgcGF5bG9hZC5hcHByb3hpbWF0ZV9wcmVzZW5jZV9jb3VudCkgZ3VpbGQuYXBwcm94aW1hdGVQcmVzZW5jZUNvdW50ID0gcGF5bG9hZC5hcHByb3hpbWF0ZV9wcmVzZW5jZV9jb3VudFxuICBpZiAocHJvcHMuZGVmYXVsdE1lc3NhZ2VOb3RpZmljYXRpb25zKSBndWlsZC5kZWZhdWx0TWVzc2FnZU5vdGlmaWNhdGlvbnMgPSBwYXlsb2FkLmRlZmF1bHRfbWVzc2FnZV9ub3RpZmljYXRpb25zXG4gIGlmIChwcm9wcy5kZXNjcmlwdGlvbiAmJiBwYXlsb2FkLmRlc2NyaXB0aW9uKSBndWlsZC5kZXNjcmlwdGlvbiA9IHBheWxvYWQuZGVzY3JpcHRpb25cbiAgaWYgKHByb3BzLnRvZ2dsZXMpIGd1aWxkLnRvZ2dsZXMgPSBuZXcgR3VpbGRUb2dnbGVzKHBheWxvYWQpXG4gIGlmIChwcm9wcy5leHBsaWNpdENvbnRlbnRGaWx0ZXIpIGd1aWxkLmV4cGxpY2l0Q29udGVudEZpbHRlciA9IHBheWxvYWQuZXhwbGljaXRfY29udGVudF9maWx0ZXJcbiAgaWYgKHByb3BzLm1heE1lbWJlcnMgJiYgcGF5bG9hZC5tYXhfbWVtYmVycykgZ3VpbGQubWF4TWVtYmVycyA9IHBheWxvYWQubWF4X21lbWJlcnNcbiAgaWYgKHByb3BzLm1heFByZXNlbmNlcyAmJiBwYXlsb2FkLm1heF9wcmVzZW5jZXMpIGd1aWxkLm1heFByZXNlbmNlcyA9IHBheWxvYWQubWF4X3ByZXNlbmNlcyA/PyB1bmRlZmluZWRcbiAgaWYgKHByb3BzLm1heFZpZGVvQ2hhbm5lbFVzZXJzICYmIHBheWxvYWQubWF4X3ZpZGVvX2NoYW5uZWxfdXNlcnMpIGd1aWxkLm1heFZpZGVvQ2hhbm5lbFVzZXJzID0gcGF5bG9hZC5tYXhfdmlkZW9fY2hhbm5lbF91c2Vyc1xuICBpZiAocHJvcHMubWF4U3RhZ2VWaWRlb0NoYW5uZWxVc2VycyAmJiBwYXlsb2FkLm1heF9zdGFnZV92aWRlb19jaGFubmVsX3VzZXJzKVxuICAgIGd1aWxkLm1heFN0YWdlVmlkZW9DaGFubmVsVXNlcnMgPSBwYXlsb2FkLm1heF9zdGFnZV92aWRlb19jaGFubmVsX3VzZXJzXG4gIGlmIChwcm9wcy5tZmFMZXZlbCkgZ3VpbGQubWZhTGV2ZWwgPSBwYXlsb2FkLm1mYV9sZXZlbFxuICBpZiAocHJvcHMubmFtZSAmJiBwYXlsb2FkLm5hbWUpIGd1aWxkLm5hbWUgPSBwYXlsb2FkLm5hbWVcbiAgaWYgKHByb3BzLm5zZndMZXZlbCkgZ3VpbGQubnNmd0xldmVsID0gcGF5bG9hZC5uc2Z3X2xldmVsXG4gIGlmIChwcm9wcy5wcmVmZXJyZWRMb2NhbGUgJiYgcGF5bG9hZC5wcmVmZXJyZWRfbG9jYWxlKSBndWlsZC5wcmVmZXJyZWRMb2NhbGUgPSBwYXlsb2FkLnByZWZlcnJlZF9sb2NhbGVcbiAgaWYgKHByb3BzLnByZW1pdW1TdWJzY3JpcHRpb25Db3VudCAmJiBwYXlsb2FkLnByZW1pdW1fc3Vic2NyaXB0aW9uX2NvdW50ICE9PSB1bmRlZmluZWQpXG4gICAgZ3VpbGQucHJlbWl1bVN1YnNjcmlwdGlvbkNvdW50ID0gcGF5bG9hZC5wcmVtaXVtX3N1YnNjcmlwdGlvbl9jb3VudFxuICBpZiAocHJvcHMucHJlbWl1bVRpZXIpIGd1aWxkLnByZW1pdW1UaWVyID0gcGF5bG9hZC5wcmVtaXVtX3RpZXJcbiAgaWYgKHByb3BzLnN0YWdlSW5zdGFuY2VzICYmIHBheWxvYWQuc3RhZ2VfaW5zdGFuY2VzKVxuICAgIGd1aWxkLnN0YWdlSW5zdGFuY2VzID0gcGF5bG9hZC5zdGFnZV9pbnN0YW5jZXMubWFwKChzaSkgPT4gKHtcbiAgICAgIC8qKiBUaGUgaWQgb2YgdGhpcyBTdGFnZSBpbnN0YW5jZSAqL1xuICAgICAgaWQ6IGJvdC50cmFuc2Zvcm1lcnMuc25vd2ZsYWtlKHNpLmlkKSxcbiAgICAgIC8qKiBUaGUgZ3VpbGQgaWQgb2YgdGhlIGFzc29jaWF0ZWQgU3RhZ2UgY2hhbm5lbCAqL1xuICAgICAgZ3VpbGRJZCxcbiAgICAgIC8qKiBUaGUgaWQgb2YgdGhlIGFzc29jaWF0ZWQgU3RhZ2UgY2hhbm5lbCAqL1xuICAgICAgY2hhbm5lbElkOiBib3QudHJhbnNmb3JtZXJzLnNub3dmbGFrZShzaS5jaGFubmVsX2lkKSxcbiAgICAgIC8qKiBUaGUgdG9waWMgb2YgdGhlIFN0YWdlIGluc3RhbmNlICgxLTEyMCBjaGFyYWN0ZXJzKSAqL1xuICAgICAgdG9waWM6IHNpLnRvcGljLFxuICAgIH0pKVxuICBpZiAocHJvcHMuY2hhbm5lbHMgJiYgKCEhcGF5bG9hZC5jaGFubmVscyB8fCAhIXBheWxvYWQudGhyZWFkcykpXG4gICAgZ3VpbGQuY2hhbm5lbHMgPSBuZXcgQ29sbGVjdGlvbihcbiAgICAgIFsuLi4ocGF5bG9hZC5jaGFubmVscyA/PyBbXSksIC4uLihwYXlsb2FkLnRocmVhZHMgPz8gW10pXS5tYXAoKGNoYW5uZWwpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYm90LnRyYW5zZm9ybWVycy5jaGFubmVsKGJvdCwgY2hhbm5lbCwgeyBndWlsZElkIH0pXG4gICAgICAgIC8vIFRPRE86IFdlIHNob3VsZCBjaGVjayB0aGF0IGlkIGV4aXN0cywgb3IgZWxzZSB0aGUgY29sbGVjdGlvbiB3aWxsIGhhdmUgdW5kZWZpbmVkIGFzIGl0J3Mga2V5IChUaGlzIGlzIHZhbGlkIGZvciBhbGwgdGhlIGNvbGxlY3Rpb25zIGJlbG93IGFzIHdlbGwpXG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3I6IFNlZSBUT0RPIGFib3ZlXG4gICAgICAgIHJldHVybiBbcmVzdWx0LmlkLCByZXN1bHRdXG4gICAgICB9KSxcbiAgICApXG4gIGlmIChwcm9wcy5tZW1iZXJzICYmIHBheWxvYWQubWVtYmVycylcbiAgICBndWlsZC5tZW1iZXJzID0gbmV3IENvbGxlY3Rpb24oXG4gICAgICBwYXlsb2FkLm1lbWJlcnMubWFwKChtZW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYm90LnRyYW5zZm9ybWVycy5tZW1iZXIoYm90LCBtZW1iZXIsIHsgZ3VpbGRJZCwgdXNlcklkOiBib3QudHJhbnNmb3JtZXJzLnNub3dmbGFrZShtZW1iZXIudXNlciEuaWQpIH0pXG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3I6IFNlZSBUT0RPIGFib3ZlXG4gICAgICAgIHJldHVybiBbcmVzdWx0LmlkLCByZXN1bHRdXG4gICAgICB9KSxcbiAgICApXG4gIGlmIChwcm9wcy5yb2xlcyAmJiBwYXlsb2FkLnJvbGVzKVxuICAgIGd1aWxkLnJvbGVzID0gbmV3IENvbGxlY3Rpb24oXG4gICAgICBwYXlsb2FkLnJvbGVzLm1hcCgocm9sZSkgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBib3QudHJhbnNmb3JtZXJzLnJvbGUoYm90LCByb2xlLCB7IGd1aWxkSWQgfSlcbiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvcjogU2VlIFRPRE8gYWJvdmVcbiAgICAgICAgcmV0dXJuIFtyZXN1bHQuaWQsIHJlc3VsdF1cbiAgICAgIH0pLFxuICAgIClcbiAgaWYgKHByb3BzLmVtb2ppcyAmJiBwYXlsb2FkLmVtb2ppcylcbiAgICBndWlsZC5lbW9qaXMgPSBuZXcgQ29sbGVjdGlvbihcbiAgICAgIHBheWxvYWQuZW1vamlzLm1hcCgoZW1vamkpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYm90LnRyYW5zZm9ybWVycy5lbW9qaShib3QsIGVtb2ppKVxuICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yOiBTZWUgVE9ETyBhYm92ZVxuICAgICAgICByZXR1cm4gW3Jlc3VsdC5pZCEsIHJlc3VsdF1cbiAgICAgIH0pLFxuICAgIClcbiAgaWYgKHByb3BzLnZvaWNlU3RhdGVzICYmIHBheWxvYWQudm9pY2Vfc3RhdGVzKVxuICAgIGd1aWxkLnZvaWNlU3RhdGVzID0gbmV3IENvbGxlY3Rpb24oXG4gICAgICBwYXlsb2FkLnZvaWNlX3N0YXRlcy5tYXAoKHZvaWNlU3RhdGUpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYm90LnRyYW5zZm9ybWVycy52b2ljZVN0YXRlKGJvdCwgdm9pY2VTdGF0ZSwgeyBndWlsZElkIH0pXG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3I6IFNlZSBUT0RPIGFib3ZlXG4gICAgICAgIHJldHVybiBbcmVzdWx0LnVzZXJJZCwgcmVzdWx0XVxuICAgICAgfSksXG4gICAgKVxuICBpZiAocHJvcHMuc3RpY2tlcnMgJiYgcGF5bG9hZC5zdGlja2VycylcbiAgICBndWlsZC5zdGlja2VycyA9IG5ldyBDb2xsZWN0aW9uKFxuICAgICAgcGF5bG9hZC5zdGlja2Vycz8ubWFwKChzdGlja2VyKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGJvdC50cmFuc2Zvcm1lcnMuc3RpY2tlcihib3QsIHN0aWNrZXIpXG4gICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3I6IFNlZSBUT0RPIGFib3ZlXG4gICAgICAgIHJldHVybiBbcmVzdWx0LmlkLCByZXN1bHRdXG4gICAgICB9KSxcbiAgICApXG4gIGlmIChwcm9wcy5zeXN0ZW1DaGFubmVsRmxhZ3MgJiYgcGF5bG9hZC5zeXN0ZW1fY2hhbm5lbF9mbGFncykgZ3VpbGQuc3lzdGVtQ2hhbm5lbEZsYWdzID0gcGF5bG9hZC5zeXN0ZW1fY2hhbm5lbF9mbGFnc1xuICBpZiAocHJvcHMudmFuaXR5VXJsQ29kZSAmJiBwYXlsb2FkLnZhbml0eV91cmxfY29kZSkgZ3VpbGQudmFuaXR5VXJsQ29kZSA9IHBheWxvYWQudmFuaXR5X3VybF9jb2RlXG4gIGlmIChwcm9wcy52ZXJpZmljYXRpb25MZXZlbCkgZ3VpbGQudmVyaWZpY2F0aW9uTGV2ZWwgPSBwYXlsb2FkLnZlcmlmaWNhdGlvbl9sZXZlbFxuICBpZiAocHJvcHMud2VsY29tZVNjcmVlbiAmJiBwYXlsb2FkLndlbGNvbWVfc2NyZWVuKVxuICAgIGd1aWxkLndlbGNvbWVTY3JlZW4gPSB7XG4gICAgICBkZXNjcmlwdGlvbjogcGF5bG9hZC53ZWxjb21lX3NjcmVlbi5kZXNjcmlwdGlvbiA/PyB1bmRlZmluZWQsXG4gICAgICB3ZWxjb21lQ2hhbm5lbHM6IHBheWxvYWQud2VsY29tZV9zY3JlZW4ud2VsY29tZV9jaGFubmVscy5tYXAoKHdjKSA9PiAoe1xuICAgICAgICBjaGFubmVsSWQ6IGJvdC50cmFuc2Zvcm1lcnMuc25vd2ZsYWtlKHdjLmNoYW5uZWxfaWQpLFxuICAgICAgICBkZXNjcmlwdGlvbjogd2MuZGVzY3JpcHRpb24sXG4gICAgICAgIGVtb2ppSWQ6IHdjLmVtb2ppX2lkID8gYm90LnRyYW5zZm9ybWVycy5zbm93Zmxha2Uod2MuZW1vamlfaWQpIDogdW5kZWZpbmVkLFxuICAgICAgICBlbW9qaU5hbWU6IHdjLmVtb2ppX25hbWUgPz8gdW5kZWZpbmVkLFxuICAgICAgfSkpLFxuICAgIH1cbiAgaWYgKHByb3BzLmRpc2NvdmVyeVNwbGFzaCAmJiBwYXlsb2FkLmRpc2NvdmVyeV9zcGxhc2gpIGd1aWxkLmRpc2NvdmVyeVNwbGFzaCA9IGljb25IYXNoVG9CaWdJbnQocGF5bG9hZC5kaXNjb3Zlcnlfc3BsYXNoKVxuICBpZiAocHJvcHMuam9pbmVkQXQgJiYgcGF5bG9hZC5qb2luZWRfYXQpIGd1aWxkLmpvaW5lZEF0ID0gRGF0ZS5wYXJzZShwYXlsb2FkLmpvaW5lZF9hdClcbiAgaWYgKHByb3BzLm1lbWJlckNvdW50ICYmIHBheWxvYWQubWVtYmVyX2NvdW50KSBndWlsZC5tZW1iZXJDb3VudCA9IHBheWxvYWQubWVtYmVyX2NvdW50ID8/IDBcbiAgaWYgKHByb3BzLnNoYXJkSWQgJiYgZXh0cmE/LnNoYXJkSWQpIGd1aWxkLnNoYXJkSWQgPSBleHRyYS5zaGFyZElkXG4gIGlmIChwcm9wcy5pY29uICYmIHBheWxvYWQuaWNvbikgZ3VpbGQuaWNvbiA9IGljb25IYXNoVG9CaWdJbnQocGF5bG9hZC5pY29uKVxuICBpZiAocHJvcHMuYmFubmVyICYmIHBheWxvYWQuYmFubmVyKSBndWlsZC5iYW5uZXIgPSBpY29uSGFzaFRvQmlnSW50KHBheWxvYWQuYmFubmVyKVxuICBpZiAocHJvcHMuc3BsYXNoICYmIHBheWxvYWQuc3BsYXNoKSBndWlsZC5zcGxhc2ggPSBpY29uSGFzaFRvQmlnSW50KHBheWxvYWQuc3BsYXNoKVxuICBpZiAocHJvcHMuaWQgJiYgcGF5bG9hZC5pZCkgZ3VpbGQuaWQgPSBndWlsZElkXG4gIGlmIChwcm9wcy5vd25lcklkICYmIHBheWxvYWQub3duZXJfaWQpIGd1aWxkLm93bmVySWQgPSBib3QudHJhbnNmb3JtZXJzLnNub3dmbGFrZShwYXlsb2FkLm93bmVyX2lkKVxuICBpZiAocHJvcHMucGVybWlzc2lvbnMgJiYgcGF5bG9hZC5wZXJtaXNzaW9ucykgZ3VpbGQucGVybWlzc2lvbnMgPSBib3QudHJhbnNmb3JtZXJzLnNub3dmbGFrZShwYXlsb2FkLnBlcm1pc3Npb25zKVxuICBpZiAocHJvcHMuYWZrQ2hhbm5lbElkICYmIHBheWxvYWQuYWZrX2NoYW5uZWxfaWQpIGd1aWxkLmFma0NoYW5uZWxJZCA9IGJvdC50cmFuc2Zvcm1lcnMuc25vd2ZsYWtlKHBheWxvYWQuYWZrX2NoYW5uZWxfaWQpXG4gIGlmIChwcm9wcy53aWRnZXRDaGFubmVsSWQgJiYgcGF5bG9hZC53aWRnZXRfY2hhbm5lbF9pZCkgZ3VpbGQud2lkZ2V0Q2hhbm5lbElkID0gYm90LnRyYW5zZm9ybWVycy5zbm93Zmxha2UocGF5bG9hZC53aWRnZXRfY2hhbm5lbF9pZClcbiAgaWYgKHByb3BzLmFwcGxpY2F0aW9uSWQgJiYgcGF5bG9hZC5hcHBsaWNhdGlvbl9pZCkgZ3VpbGQuYXBwbGljYXRpb25JZCA9IGJvdC50cmFuc2Zvcm1lcnMuc25vd2ZsYWtlKHBheWxvYWQuYXBwbGljYXRpb25faWQpXG4gIGlmIChwcm9wcy5zeXN0ZW1DaGFubmVsSWQgJiYgcGF5bG9hZC5zeXN0ZW1fY2hhbm5lbF9pZCkgZ3VpbGQuc3lzdGVtQ2hhbm5lbElkID0gYm90LnRyYW5zZm9ybWVycy5zbm93Zmxha2UocGF5bG9hZC5zeXN0ZW1fY2hhbm5lbF9pZClcbiAgaWYgKHByb3BzLnJ1bGVzQ2hhbm5lbElkICYmIHBheWxvYWQucnVsZXNfY2hhbm5lbF9pZCkgZ3VpbGQucnVsZXNDaGFubmVsSWQgPSBib3QudHJhbnNmb3JtZXJzLnNub3dmbGFrZShwYXlsb2FkLnJ1bGVzX2NoYW5uZWxfaWQpXG4gIGlmIChwcm9wcy5wdWJsaWNVcGRhdGVzQ2hhbm5lbElkICYmIHBheWxvYWQucHVibGljX3VwZGF0ZXNfY2hhbm5lbF9pZClcbiAgICBndWlsZC5wdWJsaWNVcGRhdGVzQ2hhbm5lbElkID0gYm90LnRyYW5zZm9ybWVycy5zbm93Zmxha2UocGF5bG9hZC5wdWJsaWNfdXBkYXRlc19jaGFubmVsX2lkKVxuICBpZiAocHJvcHMucHJlbWl1bVByb2dyZXNzQmFyRW5hYmxlZCAmJiBwYXlsb2FkLnByZW1pdW1fcHJvZ3Jlc3NfYmFyX2VuYWJsZWQpIGd1aWxkLnByZW1pdW1Qcm9ncmVzc0JhckVuYWJsZWQgPSBwYXlsb2FkLnByZW1pdW1fcHJvZ3Jlc3NfYmFyX2VuYWJsZWRcbiAgaWYgKHByb3BzLmxhcmdlICYmIHBheWxvYWQubGFyZ2UpIGd1aWxkLmxhcmdlID0gcGF5bG9hZC5sYXJnZVxuICBpZiAocHJvcHMub3duZXIgJiYgcGF5bG9hZC5vd25lcikgZ3VpbGQub3duZXIgPSBwYXlsb2FkLm93bmVyXG4gIGlmIChwcm9wcy53aWRnZXRFbmFibGVkICYmIHBheWxvYWQud2lkZ2V0X2VuYWJsZWQpIGd1aWxkLndpZGdldEVuYWJsZWQgPSBwYXlsb2FkLndpZGdldF9lbmFibGVkXG4gIGlmIChwcm9wcy51bmF2YWlsYWJsZSAmJiBwYXlsb2FkLnVuYXZhaWxhYmxlKSBndWlsZC51bmF2YWlsYWJsZSA9IHBheWxvYWQudW5hdmFpbGFibGVcbiAgaWYgKHByb3BzLmljb25IYXNoICYmIHBheWxvYWQuaWNvbl9oYXNoKSBndWlsZC5pY29uSGFzaCA9IGljb25IYXNoVG9CaWdJbnQocGF5bG9hZC5pY29uX2hhc2gpXG4gIGlmIChwcm9wcy5wcmVzZW5jZXMgJiYgcGF5bG9hZC5wcmVzZW5jZXMpXG4gICAgZ3VpbGQucHJlc2VuY2VzID0gcGF5bG9hZC5wcmVzZW5jZXM/Lm1hcCgocHJlc2VuY2UpID0+IGJvdC50cmFuc2Zvcm1lcnMucHJlc2VuY2UoYm90LCBwcmVzZW5jZSBhcyBEaXNjb3JkUHJlc2VuY2VVcGRhdGUpKVxuICBpZiAocHJvcHMuc2FmZXR5QWxlcnRzQ2hhbm5lbElkICYmIHBheWxvYWQuc2FmZXR5X2FsZXJ0c19jaGFubmVsX2lkKVxuICAgIGd1aWxkLnNhZmV0eUFsZXJ0c0NoYW5uZWxJZCA9IGJvdC50cmFuc2Zvcm1lcnMuc25vd2ZsYWtlKHBheWxvYWQuc2FmZXR5X2FsZXJ0c19jaGFubmVsX2lkKVxuICBpZiAocHJvcHMuaW5jaWRlbnRzRGF0YSAmJiBwYXlsb2FkLmluY2lkZW50c19kYXRhKSBndWlsZC5pbmNpZGVudHNEYXRhID0gYm90LnRyYW5zZm9ybWVycy5pbmNpZGVudHNEYXRhKGJvdCwgcGF5bG9hZC5pbmNpZGVudHNfZGF0YSlcblxuICByZXR1cm4gYm90LnRyYW5zZm9ybWVycy5jdXN0b21pemVycy5ndWlsZChib3QsIHBheWxvYWQsIGd1aWxkLCBleHRyYSlcbn1cbiJdLCJuYW1lcyI6WyJDaGFubmVsVHlwZXMiLCJDb2xsZWN0aW9uIiwiaWNvbkhhc2hUb0JpZ0ludCIsIkd1aWxkVG9nZ2xlcyIsImJhc2VHdWlsZCIsInVuZGVmaW5lZCIsInRocmVhZHMiLCJjaGFubmVscyIsImFycmF5IiwiZmlsdGVyIiwieCIsInR5cGUiLCJQdWJsaWNUaHJlYWQiLCJQcml2YXRlVGhyZWFkIiwiQW5ub3VuY2VtZW50VGhyZWFkIiwibWFwIiwiaWQiLCJmZWF0dXJlcyIsInRvZ2dsZXMiLCJ0cmFuc2Zvcm1HdWlsZCIsImJvdCIsInBheWxvYWQiLCJleHRyYSIsImd1aWxkSWQiLCJ0cmFuc2Zvcm1lcnMiLCJzbm93Zmxha2UiLCJwcm9wcyIsImRlc2lyZWRQcm9wZXJ0aWVzIiwiZ3VpbGQiLCJPYmplY3QiLCJjcmVhdGUiLCJhZmtUaW1lb3V0IiwiYWZrX3RpbWVvdXQiLCJhcHByb3hpbWF0ZU1lbWJlckNvdW50IiwiYXBwcm94aW1hdGVfbWVtYmVyX2NvdW50IiwiYXBwcm94aW1hdGVQcmVzZW5jZUNvdW50IiwiYXBwcm94aW1hdGVfcHJlc2VuY2VfY291bnQiLCJkZWZhdWx0TWVzc2FnZU5vdGlmaWNhdGlvbnMiLCJkZWZhdWx0X21lc3NhZ2Vfbm90aWZpY2F0aW9ucyIsImRlc2NyaXB0aW9uIiwiZXhwbGljaXRDb250ZW50RmlsdGVyIiwiZXhwbGljaXRfY29udGVudF9maWx0ZXIiLCJtYXhNZW1iZXJzIiwibWF4X21lbWJlcnMiLCJtYXhQcmVzZW5jZXMiLCJtYXhfcHJlc2VuY2VzIiwibWF4VmlkZW9DaGFubmVsVXNlcnMiLCJtYXhfdmlkZW9fY2hhbm5lbF91c2VycyIsIm1heFN0YWdlVmlkZW9DaGFubmVsVXNlcnMiLCJtYXhfc3RhZ2VfdmlkZW9fY2hhbm5lbF91c2VycyIsIm1mYUxldmVsIiwibWZhX2xldmVsIiwibmFtZSIsIm5zZndMZXZlbCIsIm5zZndfbGV2ZWwiLCJwcmVmZXJyZWRMb2NhbGUiLCJwcmVmZXJyZWRfbG9jYWxlIiwicHJlbWl1bVN1YnNjcmlwdGlvbkNvdW50IiwicHJlbWl1bV9zdWJzY3JpcHRpb25fY291bnQiLCJwcmVtaXVtVGllciIsInByZW1pdW1fdGllciIsInN0YWdlSW5zdGFuY2VzIiwic3RhZ2VfaW5zdGFuY2VzIiwic2kiLCJjaGFubmVsSWQiLCJjaGFubmVsX2lkIiwidG9waWMiLCJjaGFubmVsIiwicmVzdWx0IiwibWVtYmVycyIsIm1lbWJlciIsInVzZXJJZCIsInVzZXIiLCJyb2xlcyIsInJvbGUiLCJlbW9qaXMiLCJlbW9qaSIsInZvaWNlU3RhdGVzIiwidm9pY2Vfc3RhdGVzIiwidm9pY2VTdGF0ZSIsInN0aWNrZXJzIiwic3RpY2tlciIsInN5c3RlbUNoYW5uZWxGbGFncyIsInN5c3RlbV9jaGFubmVsX2ZsYWdzIiwidmFuaXR5VXJsQ29kZSIsInZhbml0eV91cmxfY29kZSIsInZlcmlmaWNhdGlvbkxldmVsIiwidmVyaWZpY2F0aW9uX2xldmVsIiwid2VsY29tZVNjcmVlbiIsIndlbGNvbWVfc2NyZWVuIiwid2VsY29tZUNoYW5uZWxzIiwid2VsY29tZV9jaGFubmVscyIsIndjIiwiZW1vamlJZCIsImVtb2ppX2lkIiwiZW1vamlOYW1lIiwiZW1vamlfbmFtZSIsImRpc2NvdmVyeVNwbGFzaCIsImRpc2NvdmVyeV9zcGxhc2giLCJqb2luZWRBdCIsImpvaW5lZF9hdCIsIkRhdGUiLCJwYXJzZSIsIm1lbWJlckNvdW50IiwibWVtYmVyX2NvdW50Iiwic2hhcmRJZCIsImljb24iLCJiYW5uZXIiLCJzcGxhc2giLCJvd25lcklkIiwib3duZXJfaWQiLCJwZXJtaXNzaW9ucyIsImFma0NoYW5uZWxJZCIsImFma19jaGFubmVsX2lkIiwid2lkZ2V0Q2hhbm5lbElkIiwid2lkZ2V0X2NoYW5uZWxfaWQiLCJhcHBsaWNhdGlvbklkIiwiYXBwbGljYXRpb25faWQiLCJzeXN0ZW1DaGFubmVsSWQiLCJzeXN0ZW1fY2hhbm5lbF9pZCIsInJ1bGVzQ2hhbm5lbElkIiwicnVsZXNfY2hhbm5lbF9pZCIsInB1YmxpY1VwZGF0ZXNDaGFubmVsSWQiLCJwdWJsaWNfdXBkYXRlc19jaGFubmVsX2lkIiwicHJlbWl1bVByb2dyZXNzQmFyRW5hYmxlZCIsInByZW1pdW1fcHJvZ3Jlc3NfYmFyX2VuYWJsZWQiLCJsYXJnZSIsIm93bmVyIiwid2lkZ2V0RW5hYmxlZCIsIndpZGdldF9lbmFibGVkIiwidW5hdmFpbGFibGUiLCJpY29uSGFzaCIsImljb25faGFzaCIsInByZXNlbmNlcyIsInByZXNlbmNlIiwic2FmZXR5QWxlcnRzQ2hhbm5lbElkIiwic2FmZXR5X2FsZXJ0c19jaGFubmVsX2lkIiwiaW5jaWRlbnRzRGF0YSIsImluY2lkZW50c19kYXRhIiwiY3VzdG9taXplcnMiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLFlBQVksUUFBdUQsb0JBQW1CO0FBQy9GLFNBQVNDLFVBQVUsRUFBRUMsZ0JBQWdCLFFBQVEsb0JBQW1CO0FBR2hFLFNBQVNDLFlBQVksUUFBUSxxQkFBb0I7QUFHakQsT0FBTyxNQUFNQyxZQUFtQjtJQUM5QiwyRUFBMkU7SUFDM0UsR0FBSUMsU0FBUztJQUViLElBQUlDLFdBQVU7UUFDWixJQUFJLENBQUMsSUFBSSxDQUFDQyxRQUFRLEVBQUUsT0FBTyxJQUFJTjtRQUUvQixNQUFNSyxVQUFVLElBQUksQ0FBQ0Ms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